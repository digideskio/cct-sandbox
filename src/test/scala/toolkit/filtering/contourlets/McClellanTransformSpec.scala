/*
 * (c) Copyright 2016 Hewlett Packard Enterprise Development LP
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

package toolkit.filtering.contourlets

import libcog._

import org.junit.runner.RunWith
import org.scalatest.junit.JUnitRunner
import org.scalatest.FunSuite
import org.scalatest.matchers.MustMatchers

/** Test code.
  *
  * @author Greg Snider
  */
@RunWith(classOf[JUnitRunner])
class McClellanTransformSpec extends FunSuite with MustMatchers {
  test("all") {
    val b = Matrix(
      Array(1f, 2, 3, 4, 5, 6, 7, 8, 9 , 10, 11)
    )
    val t = DiamondMaxFlatFilter(4, 0)

    // result from Matlab mctrans.m for above values of b and t:
    val mctrans = Matrix(
      Array( 0.000000e+00f, 0.000000e+00f, 0.000000e+00f, 0.000000e+00f, 0.000000e+00f, -9.540979e-13f, 0.000000e+00f, -2.862294e-12f, 0.000000e+00f, -6.297046e-12f, 0.000000e+00f, -1.370085e-11f, 0.000000e+00f, -2.168474e-11f, 0.000000e+00f, -3.048320e-11f, 0.000000e+00f, -4.041253e-11f, 0.000000e+00f, -4.367631e-11f, 0.000000e+00f, -4.367631e-11f, 0.000000e+00f, -4.041253e-11f, 0.000000e+00f, -3.048320e-11f, 0.000000e+00f, -2.168474e-11f, 0.000000e+00f, -1.370085e-11f, 0.000000e+00f, -6.297046e-12f, 0.000000e+00f, -2.862294e-12f, 0.000000e+00f, -9.540979e-13f, 0.000000e+00f, 0.000000e+00f, 0.000000e+00f, 0.000000e+00f, 0.000000e+00f),
      Array( 0.000000e+00f, 0.000000e+00f, 0.000000e+00f, 0.000000e+00f, -4.770490e-12f, 0.000000e+00f, 3.816392e-11f, 0.000000e+00f, 1.297573e-10f, 0.000000e+00f, 3.098910e-10f, 0.000000e+00f, 6.602358e-10f, 0.000000e+00f, 1.042321e-09f, 0.000000e+00f, 1.469879e-09f, 0.000000e+00f, 1.811046e-09f, 0.000000e+00f, 1.892640e-09f, 0.000000e+00f, 1.811046e-09f, 0.000000e+00f, 1.469879e-09f, 0.000000e+00f, 1.042321e-09f, 0.000000e+00f, 6.602358e-10f, 0.000000e+00f, 3.098910e-10f, 0.000000e+00f, 1.297573e-10f, 0.000000e+00f, 3.816392e-11f, 0.000000e+00f, -4.770490e-12f, 0.000000e+00f, 0.000000e+00f, 0.000000e+00f, 0.000000e+00f),
      Array( 0.000000e+00f, 0.000000e+00f, 0.000000e+00f, -9.540979e-12f, 0.000000e+00f, 2.308917e-10f, 0.000000e+00f, -7.167184e-10f, 0.000000e+00f, -2.923814e-09f, 0.000000e+00f, -7.505804e-09f, 0.000000e+00f, -1.575389e-08f, 0.000000e+00f, -2.488016e-08f, 0.000000e+00f, -3.393829e-08f, 0.000000e+00f, -3.935811e-08f, 0.000000e+00f, -3.935811e-08f, 0.000000e+00f, -3.393829e-08f, 0.000000e+00f, -2.488016e-08f, 0.000000e+00f, -1.575389e-08f, 0.000000e+00f, -7.505804e-09f, 0.000000e+00f, -2.923814e-09f, 0.000000e+00f, -7.167184e-10f, 0.000000e+00f, 2.308917e-10f, 0.000000e+00f, -9.540979e-12f, 0.000000e+00f, 0.000000e+00f, 0.000000e+00f),
      Array( 0.000000e+00f, 0.000000e+00f, -9.540979e-12f, 0.000000e+00f, 4.818194e-10f, 0.000000e+00f, -5.589106e-09f, 0.000000e+00f, 8.193030e-09f, 0.000000e+00f, 4.372791e-08f, 0.000000e+00f, 1.198420e-07f, 0.000000e+00f, 2.495379e-07f, 0.000000e+00f, 3.873317e-07f, 0.000000e+00f, 5.030839e-07f, 0.000000e+00f, 5.498051e-07f, 0.000000e+00f, 5.030839e-07f, 0.000000e+00f, 3.873317e-07f, 0.000000e+00f, 2.495379e-07f, 0.000000e+00f, 1.198420e-07f, 0.000000e+00f, 4.372791e-08f, 0.000000e+00f, 8.193030e-09f, 0.000000e+00f, -5.589106e-09f, 0.000000e+00f, 4.818194e-10f, 0.000000e+00f, -9.540979e-12f, 0.000000e+00f, 0.000000e+00f),
      Array( 0.000000e+00f, -4.770490e-12f, 0.000000e+00f, 4.818194e-10f, 0.000000e+00f, -1.221875e-08f, 0.000000e+00f, 9.194882e-08f, 3.552714e-10f, -5.347029e-08f, 8.526513e-10f, -4.771115e-07f, 1.620037e-09f, -1.405523e-06f, 3.262812e-09f, -2.895859e-06f, 4.292247e-09f, -4.345536e-06f, 5.197762e-09f, -5.326711e-06f, 6.091341e-09f, -5.326711e-06f, 5.197762e-09f, -4.345536e-06f, 4.292247e-09f, -2.895859e-06f, 3.262812e-09f, -1.405523e-06f, 1.620037e-09f, -4.771115e-07f, 8.526513e-10f, -5.347029e-08f, 3.552714e-10f, 9.194882e-08f, 0.000000e+00f, -1.221875e-08f, 0.000000e+00f, 4.818194e-10f, 0.000000e+00f, -4.770490e-12f, 0.000000e+00f),
      Array( -9.540979e-13f, 0.000000e+00f, 2.308917e-10f, 0.000000e+00f, -1.221875e-08f, 0.000000e+00f, 2.114749e-07f, 1.421085e-09f, -1.143003e-06f, -1.222134e-08f, -2.710544e-09f, -3.217338e-08f, 3.922157e-06f, -6.709797e-08f, 1.266647e-05f, -1.248941e-07f, 2.566395e-05f, -1.631292e-07f, 3.676042e-05f, -1.979515e-07f, 4.140954e-05f, -1.979515e-07f, 3.676042e-05f, -1.631292e-07f, 2.566395e-05f, -1.248941e-07f, 1.266647e-05f, -6.709797e-08f, 3.922157e-06f, -3.217338e-08f, -2.710544e-09f, -1.222134e-08f, -1.143003e-06f, 1.421085e-09f, 2.114749e-07f, 0.000000e+00f, -1.221875e-08f, 0.000000e+00f, 2.308917e-10f, 0.000000e+00f, -9.540979e-13f),
      Array( 0.000000e+00f, 3.816392e-11f, 0.000000e+00f, -5.589106e-09f, 0.000000e+00f, 2.114749e-07f, 2.131628e-09f, -2.780464e-06f, -5.655920e-08f, 1.122685e-05f, 2.035279e-07f, 4.773722e-06f, 6.127493e-07f, -2.420405e-05f, 1.342590e-06f, -8.928046e-05f, 2.359000e-06f, -1.769009e-04f, 3.071110e-06f, -2.358283e-04f, 3.408340e-06f, -2.358283e-04f, 3.071110e-06f, -1.769009e-04f, 2.359000e-06f, -8.928046e-05f, 1.342590e-06f, -2.420405e-05f, 6.127493e-07f, 4.773722e-06f, 2.035279e-07f, 1.122685e-05f, -5.655920e-08f, -2.780464e-06f, 2.131628e-09f, 2.114749e-07f, 0.000000e+00f, -5.589106e-09f, 0.000000e+00f, 3.816392e-11f, 0.000000e+00f),
      Array( -2.862294e-12f, 0.000000e+00f, -7.167184e-10f, 0.000000e+00f, 9.194882e-08f, 1.421085e-09f, -2.780464e-06f, -8.697043e-08f, 2.908844e-05f, 1.129592e-06f, -8.940999e-05f, -2.219429e-06f, -6.713657e-05f, -7.813662e-06f, 1.052414e-04f, -1.749572e-05f, 4.915803e-04f, -2.956697e-05f, 9.397036e-04f, -3.633546e-05f, 1.123315e-03f, -3.633546e-05f, 9.397036e-04f, -2.956697e-05f, 4.915803e-04f, -1.749572e-05f, 1.052414e-04f, -7.813662e-06f, -6.713657e-05f, -2.219429e-06f, -8.940999e-05f, 1.129592e-06f, 2.908844e-05f, -8.697043e-08f, -2.780464e-06f, 1.421085e-09f, 9.194882e-08f, 0.000000e+00f, -7.167184e-10f, 0.000000e+00f, -2.862294e-12f),
      Array( 0.000000e+00f, 1.297573e-10f, 0.000000e+00f, 8.193030e-09f, 3.552714e-10f, -1.143003e-06f, -5.655920e-08f, 2.908844e-05f, 1.784542e-06f, -2.489027e-04f, -1.554760e-05f, 5.834899e-04f, 1.655990e-05f, 5.894341e-04f, 7.239968e-05f, -2.380197e-04f, 1.652382e-04f, -2.051512e-03f, 2.627506e-04f, -3.698716e-03f, 2.952092e-04f, -3.698716e-03f, 2.627506e-04f, -2.051512e-03f, 1.652382e-04f, -2.380197e-04f, 7.239968e-05f, 5.894341e-04f, 1.655990e-05f, 5.834899e-04f, -1.554760e-05f, -2.489027e-04f, 1.784542e-06f, 2.908844e-05f, -5.655920e-08f, -1.143003e-06f, 3.552714e-10f, 8.193030e-09f, 0.000000e+00f, 1.297573e-10f, 0.000000e+00f),
      Array( -6.297046e-12f, 0.000000e+00f, -2.923814e-09f, 0.000000e+00f, -5.347029e-08f, -1.222134e-08f, 1.122685e-05f, 1.129592e-06f, -2.489027e-04f, -2.529011e-05f, 1.765296e-03f, 1.613209e-04f, -3.115100e-03f, -7.657324e-05f, -3.803384e-03f, -5.036610e-04f, -6.062279e-04f, -1.159517e-03f, 5.940803e-03f, -1.690553e-03f, 9.640725e-03f, -1.690553e-03f, 5.940803e-03f, -1.159517e-03f, -6.062279e-04f, -5.036610e-04f, -3.803384e-03f, -7.657324e-05f, -3.115100e-03f, 1.613209e-04f, 1.765296e-03f, -2.529011e-05f, -2.489027e-04f, 1.129592e-06f, 1.122685e-05f, -1.222134e-08f, -5.347029e-08f, 0.000000e+00f, -2.923814e-09f, 0.000000e+00f, -6.297046e-12f),
      Array( 0.000000e+00f, 3.098910e-10f, 0.000000e+00f, 4.372791e-08f, 8.526513e-10f, -2.710544e-09f, 2.035279e-07f, -8.940999e-05f, -1.554760e-05f, 1.765296e-03f, 2.709511e-04f, -1.040521e-02f, -1.302924e-03f, 1.346408e-02f, 8.815868e-05f, 1.872586e-02f, 2.628814e-03f, 8.831275e-03f, 6.030193e-03f, -8.233895e-03f, 7.830019e-03f, -8.233895e-03f, 6.030193e-03f, 8.831275e-03f, 2.628814e-03f, 1.872586e-02f, 8.815868e-05f, 1.346408e-02f, -1.302924e-03f, -1.040521e-02f, 2.709511e-04f, 1.765296e-03f, -1.554760e-05f, -8.940999e-05f, 2.035279e-07f, -2.710544e-09f, 8.526513e-10f, 4.372791e-08f, 0.000000e+00f, 3.098910e-10f, 0.000000e+00f),
      Array( -1.370085e-11f, 0.000000e+00f, -7.505804e-09f, 0.000000e+00f, -4.771115e-07f, -3.217338e-08f, 4.773722e-06f, -2.219429e-06f, 5.834899e-04f, 1.613209e-04f, -1.040521e-02f, -2.267856e-03f, 5.080497e-02f, 8.389219e-03f, -4.571598e-02f, 1.891330e-03f, -6.965745e-02f, -9.826065e-03f, -4.524756e-02f, -2.243491e-02f, -1.963838e-02f, -2.243491e-02f, -4.524756e-02f, -9.826065e-03f, -6.965745e-02f, 1.891330e-03f, -4.571598e-02f, 8.389219e-03f, 5.080497e-02f, -2.267856e-03f, -1.040521e-02f, 1.613209e-04f, 5.834899e-04f, -2.219429e-06f, 4.773722e-06f, -3.217338e-08f, -4.771115e-07f, 0.000000e+00f, -7.505804e-09f, 0.000000e+00f, -1.370085e-11f),
      Array( 0.000000e+00f, 6.602358e-10f, 0.000000e+00f, 1.198420e-07f, 1.620037e-09f, 3.922157e-06f, 6.127493e-07f, -6.713657e-05f, 1.655990e-05f, -3.115100e-03f, -1.302924e-03f, 5.080497e-02f, 1.519864e-02f, -2.024327e-01f, -4.289395e-02f, 1.139847e-01f, -1.847240e-02f, 1.853753e-01f, 2.274617e-02f, 1.365158e-01f, 4.859738e-02f, 1.365158e-01f, 2.274617e-02f, 1.853753e-01f, -1.847240e-02f, 1.139847e-01f, -4.289395e-02f, -2.024327e-01f, 1.519864e-02f, 5.080497e-02f, -1.302924e-03f, -3.115100e-03f, 1.655990e-05f, -6.713657e-05f, 6.127493e-07f, 3.922157e-06f, 1.620037e-09f, 1.198420e-07f, 0.000000e+00f, 6.602358e-10f, 0.000000e+00f),
      Array( -2.168474e-11f, 0.000000e+00f, -1.575389e-08f, 0.000000e+00f, -1.405523e-06f, -6.709797e-08f, -2.420405e-05f, -7.813662e-06f, 5.894341e-04f, -7.657324e-05f, 1.346408e-02f, 8.389219e-03f, -2.024327e-01f, -8.138851e-02f, 6.390505e-01f, 1.705640e-01f, -1.724091e-01f, 9.592487e-02f, -2.898856e-01f, -6.717787e-03f, -2.227058e-01f, -6.717787e-03f, -2.898856e-01f, 9.592487e-02f, -1.724091e-01f, 1.705640e-01f, 6.390505e-01f, -8.138851e-02f, -2.024327e-01f, 8.389219e-03f, 1.346408e-02f, -7.657324e-05f, 5.894341e-04f, -7.813662e-06f, -2.420405e-05f, -6.709797e-08f, -1.405523e-06f, 0.000000e+00f, -1.575389e-08f, 0.000000e+00f, -2.168474e-11f),
      Array( 0.000000e+00f, 1.042321e-09f, 0.000000e+00f, 2.495379e-07f, 3.262812e-09f, 1.266647e-05f, 1.342590e-06f, 1.052414e-04f, 7.239968e-05f, -3.803384e-03f, 8.815868e-05f, -4.571598e-02f, -4.289395e-02f, 6.390505e-01f, 3.423096e-01f, -1.514943e+00f, -5.099286e-01f, -1.487306e-02f, -3.120043e-01f, 1.176450e-02f, -1.630136e-01f, 1.176450e-02f, -3.120043e-01f, -1.487306e-02f, -5.099286e-01f, -1.514943e+00f, 3.423096e-01f, 6.390505e-01f, -4.289395e-02f, -4.571598e-02f, 8.815868e-05f, -3.803384e-03f, 7.239968e-05f, 1.052414e-04f, 1.342590e-06f, 1.266647e-05f, 3.262812e-09f, 2.495379e-07f, 0.000000e+00f, 1.042321e-09f, 0.000000e+00f),
      Array( -3.048320e-11f, 0.000000e+00f, -2.488016e-08f, 0.000000e+00f, -2.895859e-06f, -1.248941e-07f, -8.928046e-05f, -1.749572e-05f, -2.380197e-04f, -5.036610e-04f, 1.872586e-02f, 1.891330e-03f, 1.139847e-01f, 1.705640e-01f, -1.514943e+00f, -1.101714e+00f, 2.328234e+00f, 9.993206e-01f, 7.576382e-01f, 5.739135e-01f, 9.786640e-01f, 5.739135e-01f, 7.576382e-01f, 9.993206e-01f, 2.328234e+00f, -1.101714e+00f, -1.514943e+00f, 1.705640e-01f, 1.139847e-01f, 1.891330e-03f, 1.872586e-02f, -5.036610e-04f, -2.380197e-04f, -1.749572e-05f, -8.928046e-05f, -1.248941e-07f, -2.895859e-06f, 0.000000e+00f, -2.488016e-08f, 0.000000e+00f, -3.048320e-11f),
      Array( 0.000000e+00f, 1.469879e-09f, 0.000000e+00f, 3.873317e-07f, 4.292247e-09f, 2.566395e-05f, 2.359000e-06f, 4.915803e-04f, 1.652382e-04f, -6.062279e-04f, 2.628814e-03f, -6.965745e-02f, -1.847240e-02f, -1.724091e-01f, -5.099286e-01f, 2.328234e+00f, 2.452402e+00f, -1.273905e+00f, -8.152501e-01f, -1.568550e+00f, -2.621791e-01f, -1.568550e+00f, -8.152501e-01f, -1.273905e+00f, 2.452402e+00f, 2.328234e+00f, -5.099286e-01f, -1.724091e-01f, -1.847240e-02f, -6.965745e-02f, 2.628814e-03f, -6.062279e-04f, 1.652382e-04f, 4.915803e-04f, 2.359000e-06f, 2.566395e-05f, 4.292247e-09f, 3.873317e-07f, 0.000000e+00f, 1.469879e-09f, 0.000000e+00f),
      Array( -4.041253e-11f, 0.000000e+00f, -3.393829e-08f, 0.000000e+00f, -4.345536e-06f, -1.631292e-07f, -1.769009e-04f, -2.956697e-05f, -2.051512e-03f, -1.159517e-03f, 8.831275e-03f, -9.826065e-03f, 1.853753e-01f, 9.592487e-02f, -1.487306e-02f, 9.993206e-01f, -1.273905e+00f, -3.019348e+00f, -2.562228e+00f, -1.323123e+00f, 6.835679e-01f, -1.323123e+00f, -2.562228e+00f, -3.019348e+00f, -1.273905e+00f, 9.993206e-01f, -1.487306e-02f, 9.592487e-02f, 1.853753e-01f, -9.826065e-03f, 8.831275e-03f, -1.159517e-03f, -2.051512e-03f, -2.956697e-05f, -1.769009e-04f, -1.631292e-07f, -4.345536e-06f, 0.000000e+00f, -3.393829e-08f, 0.000000e+00f, -4.041253e-11f),
      Array( 0.000000e+00f, 1.811046e-09f, 0.000000e+00f, 5.030839e-07f, 5.197762e-09f, 3.676042e-05f, 3.071110e-06f, 9.397036e-04f, 2.627506e-04f, 5.940803e-03f, 6.030193e-03f, -4.524756e-02f, 2.274617e-02f, -2.898856e-01f, -3.120043e-01f, 7.576382e-01f, -8.152501e-01f, -2.562228e+00f, -1.178418e-01f, 4.247727e+00f, 4.842536e+00f, 4.247727e+00f, -1.178418e-01f, -2.562228e+00f, -8.152501e-01f, 7.576382e-01f, -3.120043e-01f, -2.898856e-01f, 2.274617e-02f, -4.524756e-02f, 6.030193e-03f, 5.940803e-03f, 2.627506e-04f, 9.397036e-04f, 3.071110e-06f, 3.676042e-05f, 5.197762e-09f, 5.030839e-07f, 0.000000e+00f, 1.811046e-09f, 0.000000e+00f),
      Array( -4.367631e-11f, 0.000000e+00f, -3.935811e-08f, 0.000000e+00f, -5.326711e-06f, -1.979515e-07f, -2.358283e-04f, -3.633546e-05f, -3.698716e-03f, -1.690553e-03f, -8.233895e-03f, -2.243491e-02f, 1.365158e-01f, -6.717787e-03f, 1.176450e-02f, 5.739135e-01f, -1.568550e+00f, -1.323123e+00f, 4.247727e+00f, 7.235663e+00f, 1.060989e+01f, 7.235663e+00f, 4.247727e+00f, -1.323123e+00f, -1.568550e+00f, 5.739135e-01f, 1.176450e-02f, -6.717787e-03f, 1.365158e-01f, -2.243491e-02f, -8.233895e-03f, -1.690553e-03f, -3.698716e-03f, -3.633546e-05f, -2.358283e-04f, -1.979515e-07f, -5.326711e-06f, 0.000000e+00f, -3.935811e-08f, 0.000000e+00f, -4.367631e-11f),
      Array( 0.000000e+00f, 1.892640e-09f, 0.000000e+00f, 5.498051e-07f, 6.091341e-09f, 4.140954e-05f, 3.408340e-06f, 1.123315e-03f, 2.952092e-04f, 9.640725e-03f, 7.830019e-03f, -1.963838e-02f, 4.859738e-02f, -2.227058e-01f, -1.630136e-01f, 9.786640e-01f, -2.621791e-01f, 6.835679e-01f, 4.842536e+00f, 1.060989e+01f, 1.067716e+01f, 1.060989e+01f, 4.842536e+00f, 6.835679e-01f, -2.621791e-01f, 9.786640e-01f, -1.630136e-01f, -2.227058e-01f, 4.859738e-02f, -1.963838e-02f, 7.830019e-03f, 9.640725e-03f, 2.952092e-04f, 1.123315e-03f, 3.408340e-06f, 4.140954e-05f, 6.091341e-09f, 5.498051e-07f, 0.000000e+00f, 1.892640e-09f, 0.000000e+00f),
      Array( -4.367631e-11f, 0.000000e+00f, -3.935811e-08f, 0.000000e+00f, -5.326711e-06f, -1.979515e-07f, -2.358283e-04f, -3.633546e-05f, -3.698716e-03f, -1.690553e-03f, -8.233895e-03f, -2.243491e-02f, 1.365158e-01f, -6.717787e-03f, 1.176450e-02f, 5.739135e-01f, -1.568550e+00f, -1.323123e+00f, 4.247727e+00f, 7.235663e+00f, 1.060989e+01f, 7.235663e+00f, 4.247727e+00f, -1.323123e+00f, -1.568550e+00f, 5.739135e-01f, 1.176450e-02f, -6.717787e-03f, 1.365158e-01f, -2.243491e-02f, -8.233895e-03f, -1.690553e-03f, -3.698716e-03f, -3.633546e-05f, -2.358283e-04f, -1.979515e-07f, -5.326711e-06f, 0.000000e+00f, -3.935811e-08f, 0.000000e+00f, -4.367631e-11f),
      Array( 0.000000e+00f, 1.811046e-09f, 0.000000e+00f, 5.030839e-07f, 5.197762e-09f, 3.676042e-05f, 3.071110e-06f, 9.397036e-04f, 2.627506e-04f, 5.940803e-03f, 6.030193e-03f, -4.524756e-02f, 2.274617e-02f, -2.898856e-01f, -3.120043e-01f, 7.576382e-01f, -8.152501e-01f, -2.562228e+00f, -1.178418e-01f, 4.247727e+00f, 4.842536e+00f, 4.247727e+00f, -1.178418e-01f, -2.562228e+00f, -8.152501e-01f, 7.576382e-01f, -3.120043e-01f, -2.898856e-01f, 2.274617e-02f, -4.524756e-02f, 6.030193e-03f, 5.940803e-03f, 2.627506e-04f, 9.397036e-04f, 3.071110e-06f, 3.676042e-05f, 5.197762e-09f, 5.030839e-07f, 0.000000e+00f, 1.811046e-09f, 0.000000e+00f),
      Array( -4.041253e-11f, 0.000000e+00f, -3.393829e-08f, 0.000000e+00f, -4.345536e-06f, -1.631292e-07f, -1.769009e-04f, -2.956697e-05f, -2.051512e-03f, -1.159517e-03f, 8.831275e-03f, -9.826065e-03f, 1.853753e-01f, 9.592487e-02f, -1.487306e-02f, 9.993206e-01f, -1.273905e+00f, -3.019348e+00f, -2.562228e+00f, -1.323123e+00f, 6.835679e-01f, -1.323123e+00f, -2.562228e+00f, -3.019348e+00f, -1.273905e+00f, 9.993206e-01f, -1.487306e-02f, 9.592487e-02f, 1.853753e-01f, -9.826065e-03f, 8.831275e-03f, -1.159517e-03f, -2.051512e-03f, -2.956697e-05f, -1.769009e-04f, -1.631292e-07f, -4.345536e-06f, 0.000000e+00f, -3.393829e-08f, 0.000000e+00f, -4.041253e-11f),
      Array( 0.000000e+00f, 1.469879e-09f, 0.000000e+00f, 3.873317e-07f, 4.292247e-09f, 2.566395e-05f, 2.359000e-06f, 4.915803e-04f, 1.652382e-04f, -6.062279e-04f, 2.628814e-03f, -6.965745e-02f, -1.847240e-02f, -1.724091e-01f, -5.099286e-01f, 2.328234e+00f, 2.452402e+00f, -1.273905e+00f, -8.152501e-01f, -1.568550e+00f, -2.621791e-01f, -1.568550e+00f, -8.152501e-01f, -1.273905e+00f, 2.452402e+00f, 2.328234e+00f, -5.099286e-01f, -1.724091e-01f, -1.847240e-02f, -6.965745e-02f, 2.628814e-03f, -6.062279e-04f, 1.652382e-04f, 4.915803e-04f, 2.359000e-06f, 2.566395e-05f, 4.292247e-09f, 3.873317e-07f, 0.000000e+00f, 1.469879e-09f, 0.000000e+00f),
      Array( -3.048320e-11f, 0.000000e+00f, -2.488016e-08f, 0.000000e+00f, -2.895859e-06f, -1.248941e-07f, -8.928046e-05f, -1.749572e-05f, -2.380197e-04f, -5.036610e-04f, 1.872586e-02f, 1.891330e-03f, 1.139847e-01f, 1.705640e-01f, -1.514943e+00f, -1.101714e+00f, 2.328234e+00f, 9.993206e-01f, 7.576382e-01f, 5.739135e-01f, 9.786640e-01f, 5.739135e-01f, 7.576382e-01f, 9.993206e-01f, 2.328234e+00f, -1.101714e+00f, -1.514943e+00f, 1.705640e-01f, 1.139847e-01f, 1.891330e-03f, 1.872586e-02f, -5.036610e-04f, -2.380197e-04f, -1.749572e-05f, -8.928046e-05f, -1.248941e-07f, -2.895859e-06f, 0.000000e+00f, -2.488016e-08f, 0.000000e+00f, -3.048320e-11f),
      Array( 0.000000e+00f, 1.042321e-09f, 0.000000e+00f, 2.495379e-07f, 3.262812e-09f, 1.266647e-05f, 1.342590e-06f, 1.052414e-04f, 7.239968e-05f, -3.803384e-03f, 8.815868e-05f, -4.571598e-02f, -4.289395e-02f, 6.390505e-01f, 3.423096e-01f, -1.514943e+00f, -5.099286e-01f, -1.487306e-02f, -3.120043e-01f, 1.176450e-02f, -1.630136e-01f, 1.176450e-02f, -3.120043e-01f, -1.487306e-02f, -5.099286e-01f, -1.514943e+00f, 3.423096e-01f, 6.390505e-01f, -4.289395e-02f, -4.571598e-02f, 8.815868e-05f, -3.803384e-03f, 7.239968e-05f, 1.052414e-04f, 1.342590e-06f, 1.266647e-05f, 3.262812e-09f, 2.495379e-07f, 0.000000e+00f, 1.042321e-09f, 0.000000e+00f),
      Array( -2.168474e-11f, 0.000000e+00f, -1.575389e-08f, 0.000000e+00f, -1.405523e-06f, -6.709797e-08f, -2.420405e-05f, -7.813662e-06f, 5.894341e-04f, -7.657324e-05f, 1.346408e-02f, 8.389219e-03f, -2.024327e-01f, -8.138851e-02f, 6.390505e-01f, 1.705640e-01f, -1.724091e-01f, 9.592487e-02f, -2.898856e-01f, -6.717787e-03f, -2.227058e-01f, -6.717787e-03f, -2.898856e-01f, 9.592487e-02f, -1.724091e-01f, 1.705640e-01f, 6.390505e-01f, -8.138851e-02f, -2.024327e-01f, 8.389219e-03f, 1.346408e-02f, -7.657324e-05f, 5.894341e-04f, -7.813662e-06f, -2.420405e-05f, -6.709797e-08f, -1.405523e-06f, 0.000000e+00f, -1.575389e-08f, 0.000000e+00f, -2.168474e-11f),
      Array( 0.000000e+00f, 6.602358e-10f, 0.000000e+00f, 1.198420e-07f, 1.620037e-09f, 3.922157e-06f, 6.127493e-07f, -6.713657e-05f, 1.655990e-05f, -3.115100e-03f, -1.302924e-03f, 5.080497e-02f, 1.519864e-02f, -2.024327e-01f, -4.289395e-02f, 1.139847e-01f, -1.847240e-02f, 1.853753e-01f, 2.274617e-02f, 1.365158e-01f, 4.859738e-02f, 1.365158e-01f, 2.274617e-02f, 1.853753e-01f, -1.847240e-02f, 1.139847e-01f, -4.289395e-02f, -2.024327e-01f, 1.519864e-02f, 5.080497e-02f, -1.302924e-03f, -3.115100e-03f, 1.655990e-05f, -6.713657e-05f, 6.127493e-07f, 3.922157e-06f, 1.620037e-09f, 1.198420e-07f, 0.000000e+00f, 6.602358e-10f, 0.000000e+00f),
      Array( -1.370085e-11f, 0.000000e+00f, -7.505804e-09f, 0.000000e+00f, -4.771115e-07f, -3.217338e-08f, 4.773722e-06f, -2.219429e-06f, 5.834899e-04f, 1.613209e-04f, -1.040521e-02f, -2.267856e-03f, 5.080497e-02f, 8.389219e-03f, -4.571598e-02f, 1.891330e-03f, -6.965745e-02f, -9.826065e-03f, -4.524756e-02f, -2.243491e-02f, -1.963838e-02f, -2.243491e-02f, -4.524756e-02f, -9.826065e-03f, -6.965745e-02f, 1.891330e-03f, -4.571598e-02f, 8.389219e-03f, 5.080497e-02f, -2.267856e-03f, -1.040521e-02f, 1.613209e-04f, 5.834899e-04f, -2.219429e-06f, 4.773722e-06f, -3.217338e-08f, -4.771115e-07f, 0.000000e+00f, -7.505804e-09f, 0.000000e+00f, -1.370085e-11f),
      Array( 0.000000e+00f, 3.098910e-10f, 0.000000e+00f, 4.372791e-08f, 8.526513e-10f, -2.710544e-09f, 2.035279e-07f, -8.940999e-05f, -1.554760e-05f, 1.765296e-03f, 2.709511e-04f, -1.040521e-02f, -1.302924e-03f, 1.346408e-02f, 8.815868e-05f, 1.872586e-02f, 2.628814e-03f, 8.831275e-03f, 6.030193e-03f, -8.233895e-03f, 7.830019e-03f, -8.233895e-03f, 6.030193e-03f, 8.831275e-03f, 2.628814e-03f, 1.872586e-02f, 8.815868e-05f, 1.346408e-02f, -1.302924e-03f, -1.040521e-02f, 2.709511e-04f, 1.765296e-03f, -1.554760e-05f, -8.940999e-05f, 2.035279e-07f, -2.710544e-09f, 8.526513e-10f, 4.372791e-08f, 0.000000e+00f, 3.098910e-10f, 0.000000e+00f),
      Array( -6.297046e-12f, 0.000000e+00f, -2.923814e-09f, 0.000000e+00f, -5.347029e-08f, -1.222134e-08f, 1.122685e-05f, 1.129592e-06f, -2.489027e-04f, -2.529011e-05f, 1.765296e-03f, 1.613209e-04f, -3.115100e-03f, -7.657324e-05f, -3.803384e-03f, -5.036610e-04f, -6.062279e-04f, -1.159517e-03f, 5.940803e-03f, -1.690553e-03f, 9.640725e-03f, -1.690553e-03f, 5.940803e-03f, -1.159517e-03f, -6.062279e-04f, -5.036610e-04f, -3.803384e-03f, -7.657324e-05f, -3.115100e-03f, 1.613209e-04f, 1.765296e-03f, -2.529011e-05f, -2.489027e-04f, 1.129592e-06f, 1.122685e-05f, -1.222134e-08f, -5.347029e-08f, 0.000000e+00f, -2.923814e-09f, 0.000000e+00f, -6.297046e-12f),
      Array( 0.000000e+00f, 1.297573e-10f, 0.000000e+00f, 8.193030e-09f, 3.552714e-10f, -1.143003e-06f, -5.655920e-08f, 2.908844e-05f, 1.784542e-06f, -2.489027e-04f, -1.554760e-05f, 5.834899e-04f, 1.655990e-05f, 5.894341e-04f, 7.239968e-05f, -2.380197e-04f, 1.652382e-04f, -2.051512e-03f, 2.627506e-04f, -3.698716e-03f, 2.952092e-04f, -3.698716e-03f, 2.627506e-04f, -2.051512e-03f, 1.652382e-04f, -2.380197e-04f, 7.239968e-05f, 5.894341e-04f, 1.655990e-05f, 5.834899e-04f, -1.554760e-05f, -2.489027e-04f, 1.784542e-06f, 2.908844e-05f, -5.655920e-08f, -1.143003e-06f, 3.552714e-10f, 8.193030e-09f, 0.000000e+00f, 1.297573e-10f, 0.000000e+00f),
      Array( -2.862294e-12f, 0.000000e+00f, -7.167184e-10f, 0.000000e+00f, 9.194882e-08f, 1.421085e-09f, -2.780464e-06f, -8.697043e-08f, 2.908844e-05f, 1.129592e-06f, -8.940999e-05f, -2.219429e-06f, -6.713657e-05f, -7.813662e-06f, 1.052414e-04f, -1.749572e-05f, 4.915803e-04f, -2.956697e-05f, 9.397036e-04f, -3.633546e-05f, 1.123315e-03f, -3.633546e-05f, 9.397036e-04f, -2.956697e-05f, 4.915803e-04f, -1.749572e-05f, 1.052414e-04f, -7.813662e-06f, -6.713657e-05f, -2.219429e-06f, -8.940999e-05f, 1.129592e-06f, 2.908844e-05f, -8.697043e-08f, -2.780464e-06f, 1.421085e-09f, 9.194882e-08f, 0.000000e+00f, -7.167184e-10f, 0.000000e+00f, -2.862294e-12f),
      Array( 0.000000e+00f, 3.816392e-11f, 0.000000e+00f, -5.589106e-09f, 0.000000e+00f, 2.114749e-07f, 2.131628e-09f, -2.780464e-06f, -5.655920e-08f, 1.122685e-05f, 2.035279e-07f, 4.773722e-06f, 6.127493e-07f, -2.420405e-05f, 1.342590e-06f, -8.928046e-05f, 2.359000e-06f, -1.769009e-04f, 3.071110e-06f, -2.358283e-04f, 3.408340e-06f, -2.358283e-04f, 3.071110e-06f, -1.769009e-04f, 2.359000e-06f, -8.928046e-05f, 1.342590e-06f, -2.420405e-05f, 6.127493e-07f, 4.773722e-06f, 2.035279e-07f, 1.122685e-05f, -5.655920e-08f, -2.780464e-06f, 2.131628e-09f, 2.114749e-07f, 0.000000e+00f, -5.589106e-09f, 0.000000e+00f, 3.816392e-11f, 0.000000e+00f),
      Array( -9.540979e-13f, 0.000000e+00f, 2.308917e-10f, 0.000000e+00f, -1.221875e-08f, 0.000000e+00f, 2.114749e-07f, 1.421085e-09f, -1.143003e-06f, -1.222134e-08f, -2.710544e-09f, -3.217338e-08f, 3.922157e-06f, -6.709797e-08f, 1.266647e-05f, -1.248941e-07f, 2.566395e-05f, -1.631292e-07f, 3.676042e-05f, -1.979515e-07f, 4.140954e-05f, -1.979515e-07f, 3.676042e-05f, -1.631292e-07f, 2.566395e-05f, -1.248941e-07f, 1.266647e-05f, -6.709797e-08f, 3.922157e-06f, -3.217338e-08f, -2.710544e-09f, -1.222134e-08f, -1.143003e-06f, 1.421085e-09f, 2.114749e-07f, 0.000000e+00f, -1.221875e-08f, 0.000000e+00f, 2.308917e-10f, 0.000000e+00f, -9.540979e-13f),
      Array( 0.000000e+00f, -4.770490e-12f, 0.000000e+00f, 4.818194e-10f, 0.000000e+00f, -1.221875e-08f, 0.000000e+00f, 9.194882e-08f, 3.552714e-10f, -5.347029e-08f, 8.526513e-10f, -4.771115e-07f, 1.620037e-09f, -1.405523e-06f, 3.262812e-09f, -2.895859e-06f, 4.292247e-09f, -4.345536e-06f, 5.197762e-09f, -5.326711e-06f, 6.091341e-09f, -5.326711e-06f, 5.197762e-09f, -4.345536e-06f, 4.292247e-09f, -2.895859e-06f, 3.262812e-09f, -1.405523e-06f, 1.620037e-09f, -4.771115e-07f, 8.526513e-10f, -5.347029e-08f, 3.552714e-10f, 9.194882e-08f, 0.000000e+00f, -1.221875e-08f, 0.000000e+00f, 4.818194e-10f, 0.000000e+00f, -4.770490e-12f, 0.000000e+00f),
      Array( 0.000000e+00f, 0.000000e+00f, -9.540979e-12f, 0.000000e+00f, 4.818194e-10f, 0.000000e+00f, -5.589106e-09f, 0.000000e+00f, 8.193030e-09f, 0.000000e+00f, 4.372791e-08f, 0.000000e+00f, 1.198420e-07f, 0.000000e+00f, 2.495379e-07f, 0.000000e+00f, 3.873317e-07f, 0.000000e+00f, 5.030839e-07f, 0.000000e+00f, 5.498051e-07f, 0.000000e+00f, 5.030839e-07f, 0.000000e+00f, 3.873317e-07f, 0.000000e+00f, 2.495379e-07f, 0.000000e+00f, 1.198420e-07f, 0.000000e+00f, 4.372791e-08f, 0.000000e+00f, 8.193030e-09f, 0.000000e+00f, -5.589106e-09f, 0.000000e+00f, 4.818194e-10f, 0.000000e+00f, -9.540979e-12f, 0.000000e+00f, 0.000000e+00f),
      Array( 0.000000e+00f, 0.000000e+00f, 0.000000e+00f, -9.540979e-12f, 0.000000e+00f, 2.308917e-10f, 0.000000e+00f, -7.167184e-10f, 0.000000e+00f, -2.923814e-09f, 0.000000e+00f, -7.505804e-09f, 0.000000e+00f, -1.575389e-08f, 0.000000e+00f, -2.488016e-08f, 0.000000e+00f, -3.393829e-08f, 0.000000e+00f, -3.935811e-08f, 0.000000e+00f, -3.935811e-08f, 0.000000e+00f, -3.393829e-08f, 0.000000e+00f, -2.488016e-08f, 0.000000e+00f, -1.575389e-08f, 0.000000e+00f, -7.505804e-09f, 0.000000e+00f, -2.923814e-09f, 0.000000e+00f, -7.167184e-10f, 0.000000e+00f, 2.308917e-10f, 0.000000e+00f, -9.540979e-12f, 0.000000e+00f, 0.000000e+00f, 0.000000e+00f),
      Array( 0.000000e+00f, 0.000000e+00f, 0.000000e+00f, 0.000000e+00f, -4.770490e-12f, 0.000000e+00f, 3.816392e-11f, 0.000000e+00f, 1.297573e-10f, 0.000000e+00f, 3.098910e-10f, 0.000000e+00f, 6.602358e-10f, 0.000000e+00f, 1.042321e-09f, 0.000000e+00f, 1.469879e-09f, 0.000000e+00f, 1.811046e-09f, 0.000000e+00f, 1.892640e-09f, 0.000000e+00f, 1.811046e-09f, 0.000000e+00f, 1.469879e-09f, 0.000000e+00f, 1.042321e-09f, 0.000000e+00f, 6.602358e-10f, 0.000000e+00f, 3.098910e-10f, 0.000000e+00f, 1.297573e-10f, 0.000000e+00f, 3.816392e-11f, 0.000000e+00f, -4.770490e-12f, 0.000000e+00f, 0.000000e+00f, 0.000000e+00f, 0.000000e+00f),
      Array( 0.000000e+00f, 0.000000e+00f, 0.000000e+00f, 0.000000e+00f, 0.000000e+00f, -9.540979e-13f, 0.000000e+00f, -2.862294e-12f, 0.000000e+00f, -6.297046e-12f, 0.000000e+00f, -1.370085e-11f, 0.000000e+00f, -2.168474e-11f, 0.000000e+00f, -3.048320e-11f, 0.000000e+00f, -4.041253e-11f, 0.000000e+00f, -4.367631e-11f, 0.000000e+00f, -4.367631e-11f, 0.000000e+00f, -4.041253e-11f, 0.000000e+00f, -3.048320e-11f, 0.000000e+00f, -2.168474e-11f, 0.000000e+00f, -1.370085e-11f, 0.000000e+00f, -6.297046e-12f, 0.000000e+00f, -2.862294e-12f, 0.000000e+00f, -9.540979e-13f, 0.000000e+00f, 0.000000e+00f, 0.000000e+00f, 0.000000e+00f, 0.000000e+00f)
    )

    val filter = McClellanTransform(b, t)
    require(filter ~== mctrans)
  }
}