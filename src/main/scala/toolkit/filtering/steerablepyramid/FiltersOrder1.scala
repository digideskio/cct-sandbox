/*
 * (c) Copyright 2016 Hewlett Packard Enterprise Development LP
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

package toolkit.filtering.steerablepyramid

import libcog._

/**
  * Filters for the order-1 Steerable Pyramid, ported from Matlab code.
  * (http://www.cns.nyu.edu/~eero/steerpyr/)
  *
  * @author Greg Snider
  */

object FiltersOrder1 extends Filters {
  val harmonics = Array(1)

  // filters only contain first harmonic.
  val mtx = toScalarField(Matrix(
    Array(1f, 0f),
    Array(0f, 1f)
  ))

  val lowpass0 = toScalarField(Matrix(
    Array(-8.701000e-05f, -1.354280e-03f, -1.601260e-03f, -5.033700e-04f, 2.524010e-03f, -5.033700e-04f, -1.601260e-03f, -1.354280e-03f, -8.701000e-05f),
    Array(-1.354280e-03f, 2.921580e-03f, 7.522720e-03f, 8.224420e-03f, 1.107620e-03f, 8.224420e-03f, 7.522720e-03f, 2.921580e-03f, -1.354280e-03f),
    Array(-1.601260e-03f, 7.522720e-03f, -7.061290e-03f, -3.769487e-02f, -3.297137e-02f, -3.769487e-02f, -7.061290e-03f, 7.522720e-03f, -1.601260e-03f),
    Array(-5.033700e-04f, 8.224420e-03f, -3.769487e-02f, 4.381320e-02f, 1.811603e-01f, 4.381320e-02f, -3.769487e-02f, 8.224420e-03f, -5.033700e-04f),
    Array(2.524010e-03f, 1.107620e-03f, -3.297137e-02f, 1.811603e-01f, 4.376250e-01f, 1.811603e-01f, -3.297137e-02f, 1.107620e-03f, 2.524010e-03f),
    Array(-5.033700e-04f, 8.224420e-03f, -3.769487e-02f, 4.381320e-02f, 1.811603e-01f, 4.381320e-02f, -3.769487e-02f, 8.224420e-03f, -5.033700e-04f),
    Array(-1.601260e-03f, 7.522720e-03f, -7.061290e-03f, -3.769487e-02f, -3.297137e-02f, -3.769487e-02f, -7.061290e-03f, 7.522720e-03f, -1.601260e-03f),
    Array(-1.354280e-03f, 2.921580e-03f, 7.522720e-03f, 8.224420e-03f, 1.107620e-03f, 8.224420e-03f, 7.522720e-03f, 2.921580e-03f, -1.354280e-03f),
    Array(-8.701000e-05f, -1.354280e-03f, -1.601260e-03f, -5.033700e-04f, 2.524010e-03f, -5.033700e-04f, -1.601260e-03f, -1.354280e-03f, -8.701000e-05f)
  ))

  val lowpass = toScalarField(Matrix(
    Array(-4.350000e-05f, 1.207800e-04f, -6.771400e-04f, -1.243400e-04f, -8.006400e-04f, -1.597040e-03f, -2.516800e-04f, -4.202000e-04f, 1.262000e-03f, -4.202000e-04f, -2.516800e-04f, -1.597040e-03f, -8.006400e-04f, -1.243400e-04f, -6.771400e-04f, 1.207800e-04f, -4.350000e-05f),
    Array(1.207800e-04f, 4.460600e-04f, -5.814600e-04f, 5.621600e-04f, -1.368800e-04f, 2.325540e-03f, 2.889860e-03f, 4.287280e-03f, 5.589400e-03f, 4.287280e-03f, 2.889860e-03f, 2.325540e-03f, -1.368800e-04f, 5.621600e-04f, -5.814600e-04f, 4.460600e-04f, 1.207800e-04f),
    Array(-6.771400e-04f, -5.814600e-04f, 1.460780e-03f, 2.160540e-03f, 3.761360e-03f, 3.080980e-03f, 4.112200e-03f, 2.221220e-03f, 5.538200e-04f, 2.221220e-03f, 4.112200e-03f, 3.080980e-03f, 3.761360e-03f, 2.160540e-03f, 1.460780e-03f, -5.814600e-04f, -6.771400e-04f),
    Array(-1.243400e-04f, 5.621600e-04f, 2.160540e-03f, 3.175780e-03f, 3.184680e-03f, -1.777480e-03f, -7.431700e-03f, -9.056920e-03f, -9.637220e-03f, -9.056920e-03f, -7.431700e-03f, -1.777480e-03f, 3.184680e-03f, 3.175780e-03f, 2.160540e-03f, 5.621600e-04f, -1.243400e-04f),
    Array(-8.006400e-04f, -1.368800e-04f, 3.761360e-03f, 3.184680e-03f, -3.530640e-03f, -1.260420e-02f, -1.884744e-02f, -1.750818e-02f, -1.648568e-02f, -1.750818e-02f, -1.884744e-02f, -1.260420e-02f, -3.530640e-03f, 3.184680e-03f, 3.761360e-03f, -1.368800e-04f, -8.006400e-04f),
    Array(-1.597040e-03f, 2.325540e-03f, 3.080980e-03f, -1.777480e-03f, -1.260420e-02f, -2.022938e-02f, -1.109170e-02f, 3.955660e-03f, 1.438512e-02f, 3.955660e-03f, -1.109170e-02f, -2.022938e-02f, -1.260420e-02f, -1.777480e-03f, 3.080980e-03f, 2.325540e-03f, -1.597040e-03f),
    Array(-2.516800e-04f, 2.889860e-03f, 4.112200e-03f, -7.431700e-03f, -1.884744e-02f, -1.109170e-02f, 2.190660e-02f, 6.806584e-02f, 9.058014e-02f, 6.806584e-02f, 2.190660e-02f, -1.109170e-02f, -1.884744e-02f, -7.431700e-03f, 4.112200e-03f, 2.889860e-03f, -2.516800e-04f),
    Array(-4.202000e-04f, 4.287280e-03f, 2.221220e-03f, -9.056920e-03f, -1.750818e-02f, 3.955660e-03f, 6.806584e-02f, 1.445500e-01f, 1.773651e-01f, 1.445500e-01f, 6.806584e-02f, 3.955660e-03f, -1.750818e-02f, -9.056920e-03f, 2.221220e-03f, 4.287280e-03f, -4.202000e-04f),
    Array(1.262000e-03f, 5.589400e-03f, 5.538200e-04f, -9.637220e-03f, -1.648568e-02f, 1.438512e-02f, 9.058014e-02f, 1.773651e-01f, 2.120374e-01f, 1.773651e-01f, 9.058014e-02f, 1.438512e-02f, -1.648568e-02f, -9.637220e-03f, 5.538200e-04f, 5.589400e-03f, 1.262000e-03f),
    Array(-4.202000e-04f, 4.287280e-03f, 2.221220e-03f, -9.056920e-03f, -1.750818e-02f, 3.955660e-03f, 6.806584e-02f, 1.445500e-01f, 1.773651e-01f, 1.445500e-01f, 6.806584e-02f, 3.955660e-03f, -1.750818e-02f, -9.056920e-03f, 2.221220e-03f, 4.287280e-03f, -4.202000e-04f),
    Array(-2.516800e-04f, 2.889860e-03f, 4.112200e-03f, -7.431700e-03f, -1.884744e-02f, -1.109170e-02f, 2.190660e-02f, 6.806584e-02f, 9.058014e-02f, 6.806584e-02f, 2.190660e-02f, -1.109170e-02f, -1.884744e-02f, -7.431700e-03f, 4.112200e-03f, 2.889860e-03f, -2.516800e-04f),
    Array(-1.597040e-03f, 2.325540e-03f, 3.080980e-03f, -1.777480e-03f, -1.260420e-02f, -2.022938e-02f, -1.109170e-02f, 3.955660e-03f, 1.438512e-02f, 3.955660e-03f, -1.109170e-02f, -2.022938e-02f, -1.260420e-02f, -1.777480e-03f, 3.080980e-03f, 2.325540e-03f, -1.597040e-03f),
    Array(-8.006400e-04f, -1.368800e-04f, 3.761360e-03f, 3.184680e-03f, -3.530640e-03f, -1.260420e-02f, -1.884744e-02f, -1.750818e-02f, -1.648568e-02f, -1.750818e-02f, -1.884744e-02f, -1.260420e-02f, -3.530640e-03f, 3.184680e-03f, 3.761360e-03f, -1.368800e-04f, -8.006400e-04f),
    Array(-1.243400e-04f, 5.621600e-04f, 2.160540e-03f, 3.175780e-03f, 3.184680e-03f, -1.777480e-03f, -7.431700e-03f, -9.056920e-03f, -9.637220e-03f, -9.056920e-03f, -7.431700e-03f, -1.777480e-03f, 3.184680e-03f, 3.175780e-03f, 2.160540e-03f, 5.621600e-04f, -1.243400e-04f),
    Array(-6.771400e-04f, -5.814600e-04f, 1.460780e-03f, 2.160540e-03f, 3.761360e-03f, 3.080980e-03f, 4.112200e-03f, 2.221220e-03f, 5.538200e-04f, 2.221220e-03f, 4.112200e-03f, 3.080980e-03f, 3.761360e-03f, 2.160540e-03f, 1.460780e-03f, -5.814600e-04f, -6.771400e-04f),
    Array(1.207800e-04f, 4.460600e-04f, -5.814600e-04f, 5.621600e-04f, -1.368800e-04f, 2.325540e-03f, 2.889860e-03f, 4.287280e-03f, 5.589400e-03f, 4.287280e-03f, 2.889860e-03f, 2.325540e-03f, -1.368800e-04f, 5.621600e-04f, -5.814600e-04f, 4.460600e-04f, 1.207800e-04f),
    Array(-4.350000e-05f, 1.207800e-04f, -6.771400e-04f, -1.243400e-04f, -8.006400e-04f, -1.597040e-03f, -2.516800e-04f, -4.202000e-04f, 1.262000e-03f, -4.202000e-04f, -2.516800e-04f, -1.597040e-03f, -8.006400e-04f, -1.243400e-04f, -6.771400e-04f, 1.207800e-04f, -4.350000e-05f)
  ))

  val highpass0 = toScalarField(Matrix(
    Array(-9.570000e-04f, -2.424100e-04f, -1.424720e-03f, -8.742600e-04f, -1.166810e-03f, -8.742600e-04f, -1.424720e-03f, -2.424100e-04f, -9.570000e-04f),
    Array(-2.424100e-04f, -4.317530e-03f, 8.998600e-04f, 9.156420e-03f, 1.098012e-02f, 9.156420e-03f, 8.998600e-04f, -4.317530e-03f, -2.424100e-04f),
    Array(-1.424720e-03f, 8.998600e-04f, 1.706347e-02f, 1.094866e-02f, -5.897780e-03f, 1.094866e-02f, 1.706347e-02f, 8.998600e-04f, -1.424720e-03f),
    Array(-8.742600e-04f, 9.156420e-03f, 1.094866e-02f, -7.841370e-02f, -1.562827e-01f, -7.841370e-02f, 1.094866e-02f, 9.156420e-03f, -8.742600e-04f),
    Array(-1.166810e-03f, 1.098012e-02f, -5.897780e-03f, -1.562827e-01f, 7.282593e-01f, -1.562827e-01f, -5.897780e-03f, 1.098012e-02f, -1.166810e-03f),
    Array(-8.742600e-04f, 9.156420e-03f, 1.094866e-02f, -7.841370e-02f, -1.562827e-01f, -7.841370e-02f, 1.094866e-02f, 9.156420e-03f, -8.742600e-04f),
    Array(-1.424720e-03f, 8.998600e-04f, 1.706347e-02f, 1.094866e-02f, -5.897780e-03f, 1.094866e-02f, 1.706347e-02f, 8.998600e-04f, -1.424720e-03f),
    Array(-2.424100e-04f, -4.317530e-03f, 8.998600e-04f, 9.156420e-03f, 1.098012e-02f, 9.156420e-03f, 8.998600e-04f, -4.317530e-03f, -2.424100e-04f),
    Array(-9.570000e-04f, -2.424100e-04f, -1.424720e-03f, -8.742600e-04f, -1.166810e-03f, -8.742600e-04f, -1.424720e-03f, -2.424100e-04f, -9.570000e-04f)
  ))

  val bandpass: Array[ScalarField] = Array(
    toScalarField(Matrix(
      Array(6.125880e-03f, -8.052600e-03f, -2.103714e-02f, -1.536890e-02f, -1.851466e-02f, -1.536890e-02f, -2.103714e-02f, -8.052600e-03f, 6.125880e-03f),
      Array(-1.287416e-02f, -9.611520e-03f, 1.023569e-02f, 6.009450e-03f, 1.872620e-03f, 6.009450e-03f, 1.023569e-02f, -9.611520e-03f, -1.287416e-02f),
      Array(-5.641530e-03f, 4.168400e-03f, -2.382180e-02f, -5.375324e-02f, -2.076086e-02f, -5.375324e-02f, -2.382180e-02f, 4.168400e-03f, -5.641530e-03f),
      Array(-8.957260e-03f, -1.751170e-03f, -1.836909e-02f, 1.265655e-01f, 2.996168e-01f, 1.265655e-01f, -1.836909e-02f, -1.751170e-03f, -8.957260e-03f),
      Array(0.000000e+00f, 0.000000e+00f, 0.000000e+00f, 0.000000e+00f, 0.000000e+00f, 0.000000e+00f, 0.000000e+00f, 0.000000e+00f, 0.000000e+00f),
      Array(8.957260e-03f, 1.751170e-03f, 1.836909e-02f, -1.265655e-01f, -2.996168e-01f, -1.265655e-01f, 1.836909e-02f, 1.751170e-03f, 8.957260e-03f),
      Array(5.641530e-03f, -4.168400e-03f, 2.382180e-02f, 5.375324e-02f, 2.076086e-02f, 5.375324e-02f, 2.382180e-02f, -4.168400e-03f, 5.641530e-03f),
      Array(1.287416e-02f, 9.611520e-03f, -1.023569e-02f, -6.009450e-03f, -1.872620e-03f, -6.009450e-03f, -1.023569e-02f, 9.611520e-03f, 1.287416e-02f),
      Array(-6.125880e-03f, 8.052600e-03f, 2.103714e-02f, 1.536890e-02f, 1.851466e-02f, 1.536890e-02f, 2.103714e-02f, 8.052600e-03f, -6.125880e-03f)
    )),
    toScalarField(Matrix(
      Array(-6.125880e-03f, 1.287416e-02f, 5.641530e-03f, 8.957260e-03f, 0.000000e+00f, -8.957260e-03f, -5.641530e-03f, -1.287416e-02f, 6.125880e-03f),
      Array(8.052600e-03f, 9.611520e-03f, -4.168400e-03f, 1.751170e-03f, 0.000000e+00f, -1.751170e-03f, 4.168400e-03f, -9.611520e-03f, -8.052600e-03f),
      Array(2.103714e-02f, -1.023569e-02f, 2.382180e-02f, 1.836909e-02f, 0.000000e+00f, -1.836909e-02f, -2.382180e-02f, 1.023569e-02f, -2.103714e-02f),
      Array(1.536890e-02f, -6.009450e-03f, 5.375324e-02f, -1.265655e-01f, 0.000000e+00f, 1.265655e-01f, -5.375324e-02f, 6.009450e-03f, -1.536890e-02f),
      Array(1.851466e-02f, -1.872620e-03f, 2.076086e-02f, -2.996168e-01f, 0.000000e+00f, 2.996168e-01f, -2.076086e-02f, 1.872620e-03f, -1.851466e-02f),
      Array(1.536890e-02f, -6.009450e-03f, 5.375324e-02f, -1.265655e-01f, 0.000000e+00f, 1.265655e-01f, -5.375324e-02f, 6.009450e-03f, -1.536890e-02f),
      Array(2.103714e-02f, -1.023569e-02f, 2.382180e-02f, 1.836909e-02f, 0.000000e+00f, -1.836909e-02f, -2.382180e-02f, 1.023569e-02f, -2.103714e-02f),
      Array(8.052600e-03f, 9.611520e-03f, -4.168400e-03f, 1.751170e-03f, 0.000000e+00f, -1.751170e-03f, 4.168400e-03f, -9.611520e-03f, -8.052600e-03f),
      Array(-6.125880e-03f, 1.287416e-02f, 5.641530e-03f, 8.957260e-03f, 0.000000e+00f, -8.957260e-03f, -5.641530e-03f, -1.287416e-02f, 6.125880e-03f)
    ))
  )
}
